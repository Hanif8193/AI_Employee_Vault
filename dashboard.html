<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Employee Vault — Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg:      #0f1117;
      --surface: #1a1d27;
      --surface2:#21253a;
      --border:  #2a2d3e;
      --accent:  #6c63ff;
      --green:   #00d4aa;
      --red:     #ff6b6b;
      --yellow:  #ffd166;
      --blue:    #48cae4;
      --text:    #e2e8f0;
      --muted:   #8892a4;
      --radius:  12px;
    }
    body { font-family:'Segoe UI',system-ui,sans-serif; background:var(--bg); color:var(--text); min-height:100vh; }

    /* Header */
    header {
      background:var(--surface); border-bottom:1px solid var(--border);
      padding:16px 32px; display:flex; align-items:center; justify-content:space-between;
      position:sticky; top:0; z-index:200;
    }
    header h1 { font-size:1.15rem; font-weight:700; }
    header h1 span { color:var(--accent); }
    .badge { font-size:.7rem; background:var(--accent); color:#fff; padding:3px 10px; border-radius:20px; font-weight:600; }

    /* Layout */
    main { max-width:1420px; margin:0 auto; padding:24px 20px 56px; }

    .section-title {
      font-size:.68rem; font-weight:700; letter-spacing:.14em; text-transform:uppercase;
      color:var(--muted); margin:36px 0 14px;
    }

    /* KPI */
    .kpi-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(155px,1fr)); gap:12px; }
    .kpi {
      background:var(--surface); border:1px solid var(--border); border-radius:var(--radius);
      padding:18px 16px; position:relative; overflow:hidden;
    }
    .kpi::before { content:''; position:absolute; top:0;left:0;right:0; height:3px; background:var(--kpi-color,var(--accent)); }
    .kpi-label { font-size:.68rem; color:var(--muted); font-weight:600; text-transform:uppercase; letter-spacing:.08em; }
    .kpi-value { font-size:1.8rem; font-weight:800; margin-top:5px; line-height:1; }
    .kpi-sub   { font-size:.72rem; color:var(--muted); margin-top:4px; }

    /* Cards & charts */
    .chart-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(360px,1fr)); gap:14px; }
    .card { background:var(--surface); border:1px solid var(--border); border-radius:var(--radius); padding:20px; }
    .card h3 { font-size:.82rem; font-weight:700; margin-bottom:16px; letter-spacing:.02em; }
    .card.wide { grid-column:1/-1; }
    .chart-wrap          { position:relative; height:230px; }
    .chart-wrap.tall     { height:300px; }
    .chart-wrap.scatter  { height:340px; }

    /* Filter bar */
    .filter-bar {
      display:flex; flex-wrap:wrap; gap:10px; align-items:center;
      background:var(--surface); border:1px solid var(--border);
      border-radius:var(--radius); padding:14px 18px; margin-bottom:0;
    }
    .filter-bar input[type=text] {
      background:var(--surface2); border:1px solid var(--border); border-radius:8px;
      color:var(--text); padding:7px 12px; font-size:.82rem; outline:none;
      width:200px; font-family:inherit;
    }
    .filter-bar input[type=text]:focus { border-color:var(--accent); }
    .filter-bar input[type=text]::placeholder { color:var(--muted); }

    .filter-bar select {
      background:var(--surface2); border:1px solid var(--border); border-radius:8px;
      color:var(--text); padding:7px 10px; font-size:.82rem; outline:none; font-family:inherit; cursor:pointer;
    }
    .filter-bar select:focus { border-color:var(--accent); }

    .dept-pills { display:flex; gap:6px; flex-wrap:wrap; }
    .dpill {
      padding:5px 12px; border-radius:20px; font-size:.72rem; font-weight:700;
      border:1px solid var(--border); background:transparent; color:var(--muted);
      cursor:pointer; transition:all .15s;
    }
    .dpill:hover { border-color:var(--accent); color:var(--accent); }
    .dpill.active { background:var(--accent); border-color:var(--accent); color:#fff; }
    .dpill.active.ds  { background:#00d4aa; border-color:#00d4aa; }
    .dpill.active.fin { background:#ffd166; border-color:#ffd166; color:#111; }
    .dpill.active.hr  { background:#ff6b6b; border-color:#ff6b6b; }
    .dpill.active.mkt { background:#48cae4; border-color:#48cae4; color:#111; }

    .toggle-btn {
      padding:6px 14px; border-radius:20px; font-size:.72rem; font-weight:700;
      border:1px solid var(--border); background:transparent; color:var(--muted);
      cursor:pointer; transition:all .15s;
    }
    .toggle-btn.active { background:var(--green); border-color:var(--green); color:#111; }

    .result-count { margin-left:auto; font-size:.78rem; color:var(--muted); white-space:nowrap; }
    .result-count strong { color:var(--text); }

    /* Table */
    .tbl-wrap { overflow-x:auto; }
    table { width:100%; border-collapse:collapse; font-size:.81rem; }
    th {
      text-align:left; padding:9px 12px; font-size:.67rem; font-weight:700;
      text-transform:uppercase; letter-spacing:.08em; color:var(--muted);
      border-bottom:1px solid var(--border); cursor:pointer; user-select:none;
    }
    th:hover { color:var(--text); }
    th.sort-asc::after  { content:' ↑'; color:var(--accent); }
    th.sort-desc::after { content:' ↓'; color:var(--accent); }
    td { padding:9px 12px; border-bottom:1px solid var(--border); }
    tr:last-child td { border-bottom:none; }
    tr:hover td { background:rgba(108,99,255,.05); }

    .pill { display:inline-block; padding:2px 9px; border-radius:20px; font-size:.68rem; font-weight:700; }
    .pill-eng { background:#6c63ff22; color:#a59eff; }
    .pill-ds  { background:#00d4aa22; color:#00d4aa; }
    .pill-fin { background:#ffd16622; color:#ffd166; }
    .pill-hr  { background:#ff6b6b22; color:#ff6b6b; }
    .pill-mkt { background:#48cae422; color:#48cae4; }

    .rank   { font-weight:800; color:var(--yellow); }
    .salary { font-weight:700; color:var(--green); }
    .high   { color:var(--green); font-weight:700; }

    .no-results { text-align:center; padding:32px; color:var(--muted); font-size:.88rem; }

    /* Salary bar inline */
    .sal-bar-wrap { display:flex; align-items:center; gap:8px; }
    .sal-bar { height:4px; border-radius:2px; background:var(--green); opacity:.7; min-width:4px; }

    ::-webkit-scrollbar { width:6px; height:6px; }
    ::-webkit-scrollbar-track { background:var(--bg); }
    ::-webkit-scrollbar-thumb { background:var(--border); border-radius:3px; }
  </style>
</head>
<body>

<header>
  <h1>AI Employee <span>Vault</span> — Workforce Dashboard</h1>
  <span class="badge">Gold Layer · 2026-02-17</span>
</header>

<main>

  <!-- KPI CARDS -->
  <p class="section-title">Workforce Overview</p>
  <div class="kpi-grid">
    <div class="kpi" style="--kpi-color:#6c63ff">
      <div class="kpi-label">Total Employees</div>
      <div class="kpi-value">30</div>
      <div class="kpi-sub">Across 6 cities</div>
    </div>
    <div class="kpi" style="--kpi-color:#00d4aa">
      <div class="kpi-label">Avg Salary</div>
      <div class="kpi-value">$87K</div>
      <div class="kpi-sub">Median $86K</div>
    </div>
    <div class="kpi" style="--kpi-color:#ffd166">
      <div class="kpi-label">Total Payroll</div>
      <div class="kpi-value">$2.61M</div>
      <div class="kpi-sub">Annual</div>
    </div>
    <div class="kpi" style="--kpi-color:#ff6b6b">
      <div class="kpi-label">Departments</div>
      <div class="kpi-value">5</div>
      <div class="kpi-sub">Engineering largest</div>
    </div>
    <div class="kpi" style="--kpi-color:#48cae4">
      <div class="kpi-label">Avg Experience</div>
      <div class="kpi-value">8.0<span style="font-size:.95rem">yr</span></div>
      <div class="kpi-sub">Avg age 33.3</div>
    </div>
    <div class="kpi" style="--kpi-color:#a8dadc">
      <div class="kpi-label">High Performers</div>
      <div class="kpi-value">10</div>
      <div class="kpi-sub">Top 25% salary</div>
    </div>
  </div>

  <!-- CHARTS: COMPENSATION & HEADCOUNT -->
  <p class="section-title">Compensation &amp; Headcount</p>
  <div class="chart-grid">
    <div class="card">
      <h3>Avg Salary by Department</h3>
      <div class="chart-wrap"><canvas id="deptSalary"></canvas></div>
    </div>
    <div class="card">
      <h3>Headcount by Department</h3>
      <div class="chart-wrap"><canvas id="deptHeadcount"></canvas></div>
    </div>
    <div class="card">
      <h3>Salary Range by Department (Min / Avg / Max)</h3>
      <div class="chart-wrap"><canvas id="deptRange"></canvas></div>
    </div>
    <div class="card">
      <h3>Salary Band Distribution</h3>
      <div class="chart-wrap"><canvas id="salaryBands"></canvas></div>
    </div>
  </div>

  <!-- CHARTS: EXPERIENCE & AGE -->
  <p class="section-title">Experience &amp; Demographics</p>
  <div class="chart-grid">
    <div class="card">
      <h3>Experience Band — Headcount &amp; Avg Salary</h3>
      <div class="chart-wrap"><canvas id="expBands"></canvas></div>
    </div>
    <div class="card">
      <h3>Tenure Category Distribution</h3>
      <div class="chart-wrap"><canvas id="tenureDonut"></canvas></div>
    </div>
    <div class="card">
      <h3>Age Distribution</h3>
      <div class="chart-wrap"><canvas id="ageDist"></canvas></div>
    </div>
    <div class="card wide">
      <h3>Salary vs Experience — All Employees (colored by department)</h3>
      <div class="chart-wrap scatter"><canvas id="scatter"></canvas></div>
    </div>
  </div>

  <!-- CHARTS: LOCATIONS -->
  <p class="section-title">Office Locations</p>
  <div class="chart-grid">
    <div class="card">
      <h3>Employees by City</h3>
      <div class="chart-wrap"><canvas id="cityEmp"></canvas></div>
    </div>
    <div class="card">
      <h3>Avg Salary by City</h3>
      <div class="chart-wrap"><canvas id="citySalary"></canvas></div>
    </div>
    <div class="card">
      <h3>Total Payroll by City</h3>
      <div class="chart-wrap"><canvas id="cityPayroll"></canvas></div>
    </div>
  </div>

  <!-- CHARTS: TOP ROLES -->
  <p class="section-title">Roles</p>
  <div class="chart-grid">
    <div class="card wide">
      <h3>Top 15 Roles by Salary</h3>
      <div class="chart-wrap tall"><canvas id="topRoles"></canvas></div>
    </div>
  </div>

  <!-- TOP EARNERS TABLE -->
  <p class="section-title">Top 5 Earners</p>
  <div class="card">
    <div class="tbl-wrap">
      <table>
        <thead><tr><th>Rank</th><th>Name</th><th>Role</th><th>Department</th><th>Salary</th><th>Experience</th><th>City</th></tr></thead>
        <tbody>
          <tr><td class="rank">#1</td><td>Justin Baker</td><td>VP of Engineering</td><td><span class="pill pill-eng">Engineering</span></td><td class="salary">$145,000</td><td>17 yr</td><td>San Francisco</td></tr>
          <tr><td class="rank">#2</td><td>Kevin Young</td><td>Principal Engineer</td><td><span class="pill pill-eng">Engineering</span></td><td class="salary">$125,000</td><td>16 yr</td><td>San Francisco</td></tr>
          <tr><td class="rank">#3</td><td>Daniel Thompson</td><td>Engineering Manager</td><td><span class="pill pill-eng">Engineering</span></td><td class="salary">$115,000</td><td>14 yr</td><td>San Francisco</td></tr>
          <tr><td class="rank">#4</td><td>Jennifer Martinez</td><td>AI Research Scientist</td><td><span class="pill pill-ds">Data Science</span></td><td class="salary">$105,000</td><td>9 yr</td><td>San Francisco</td></tr>
          <tr><td class="rank">#5</td><td>Matthew Lewis</td><td>Cloud Architect</td><td><span class="pill pill-eng">Engineering</span></td><td class="salary">$102,000</td><td>12 yr</td><td>Seattle</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- DEPARTMENT BREAKDOWN TABLE -->
  <p class="section-title">Department Breakdown</p>
  <div class="card">
    <div class="tbl-wrap">
      <table>
        <thead><tr><th>Department</th><th>Headcount</th><th>Avg Salary</th><th>Min Salary</th><th>Max Salary</th><th>Total Payroll</th><th>Avg Age</th><th>Avg Experience</th></tr></thead>
        <tbody>
          <tr><td><span class="pill pill-eng">Engineering</span></td><td>11</td><td class="salary">$98,727</td><td>$78,000</td><td>$145,000</td><td>$1,086,000</td><td>35.0</td><td>9.5 yr</td></tr>
          <tr><td><span class="pill pill-ds">Data Science</span></td><td>8</td><td class="salary">$88,500</td><td>$68,000</td><td>$105,000</td><td>$708,000</td><td>32.4</td><td>6.4 yr</td></tr>
          <tr><td><span class="pill pill-fin">Finance</span></td><td>4</td><td class="salary">$85,250</td><td>$76,000</td><td>$95,000</td><td>$341,000</td><td>37.0</td><td>11.5 yr</td></tr>
          <tr><td><span class="pill pill-hr">HR</span></td><td>4</td><td class="salary">$67,500</td><td>$60,000</td><td>$75,000</td><td>$270,000</td><td>31.5</td><td>7.3 yr</td></tr>
          <tr><td><span class="pill pill-mkt">Marketing</span></td><td>3</td><td class="salary">$68,333</td><td>$58,000</td><td>$85,000</td><td>$205,000</td><td>27.0</td><td>3.7 yr</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ALL EMPLOYEES + FILTER -->
  <p class="section-title">All Employees</p>
  <div class="filter-bar">
    <input type="text" id="searchInput" placeholder="Search name or role…" />
    <div class="dept-pills">
      <button class="dpill active" data-dept="All">All</button>
      <button class="dpill"        data-dept="Engineering">Engineering</button>
      <button class="dpill ds"     data-dept="Data Science">Data Science</button>
      <button class="dpill fin"    data-dept="Finance">Finance</button>
      <button class="dpill hr"     data-dept="HR">HR</button>
      <button class="dpill mkt"    data-dept="Marketing">Marketing</button>
    </div>
    <select id="cityFilter">
      <option value="All">All Cities</option>
      <option>San Francisco</option>
      <option>New York</option>
      <option>Chicago</option>
      <option>Seattle</option>
      <option>Austin</option>
      <option>Boston</option>
    </select>
    <select id="sortSelect">
      <option value="id">Default order</option>
      <option value="salary-desc">Salary: High → Low</option>
      <option value="salary-asc">Salary: Low → High</option>
      <option value="exp-desc">Experience: Most</option>
      <option value="exp-asc">Experience: Least</option>
      <option value="name-asc">Name: A → Z</option>
    </select>
    <button class="toggle-btn" id="highToggle">★ High Performers</button>
    <span class="result-count" id="resultCount"><strong>30</strong> of 30 employees</span>
  </div>

  <div class="card" style="border-top-left-radius:0;border-top-right-radius:0;border-top:none;margin-top:0;">
    <div class="tbl-wrap">
      <table>
        <thead>
          <tr>
            <th data-sort="id">#</th>
            <th data-sort="name">Name</th>
            <th>Department</th>
            <th>Role</th>
            <th data-sort="salary">Salary</th>
            <th>City</th>
            <th data-sort="exp">Exp</th>
            <th>Performer</th>
          </tr>
        </thead>
        <tbody id="empTable"></tbody>
      </table>
    </div>
  </div>

</main>

<script>
// ── Master data ───────────────────────────────────────────────────────────────
const employees = [
  {id:1, name:'John Smith',         dept:'Engineering', role:'Senior Data Engineer',          salary:95000, city:'San Francisco', exp:8,  age:35, high:1, tenure:'Experienced'},
  {id:2, name:'Maria Garcia',       dept:'Engineering', role:'ML Engineer',                   salary:85000, city:'New York',      exp:4,  age:28, high:0, tenure:'Established'},
  {id:3, name:'James Wilson',       dept:'HR',          role:'HR Manager',                    salary:75000, city:'Chicago',       exp:15, age:42, high:0, tenure:'Experienced'},
  {id:4, name:'Emily Chen',         dept:'Data Science',role:'Data Scientist',                salary:90000, city:'Austin',        exp:6,  age:31, high:0, tenure:'Established'},
  {id:5, name:'Michael Brown',      dept:'Engineering', role:'DevOps Engineer',               salary:88000, city:'Seattle',       exp:10, age:39, high:0, tenure:'Experienced'},
  {id:6, name:'Sarah Johnson',      dept:'Marketing',   role:'Marketing Analyst',             salary:62000, city:'Boston',        exp:3,  age:26, high:0, tenure:'New'},
  {id:7, name:'David Lee',          dept:'Data Science',role:'Senior Data Scientist',         salary:98000, city:'San Francisco', exp:7,  age:33, high:1, tenure:'Established'},
  {id:8, name:'Lisa Anderson',      dept:'Engineering', role:'Software Engineer',             salary:80000, city:'New York',      exp:5,  age:29, high:0, tenure:'Established'},
  {id:9, name:'Robert Taylor',      dept:'Finance',     role:'Financial Analyst',             salary:82000, city:'Chicago',       exp:18, age:45, high:0, tenure:'Veteran'},
  {id:10,name:'Jennifer Martinez',  dept:'Data Science',role:'AI Research Scientist',         salary:105000,city:'San Francisco', exp:9,  age:37, high:1, tenure:'Experienced'},
  {id:11,name:'William Davis',      dept:'Engineering', role:'Data Engineer',                 salary:78000, city:'Austin',        exp:5,  age:30, high:0, tenure:'Established'},
  {id:12,name:'Jessica Rodriguez',  dept:'HR',          role:'Talent Acquisition Specialist', salary:65000, city:'Seattle',       exp:4,  age:27, high:0, tenure:'Established'},
  {id:13,name:'Daniel Thompson',    dept:'Engineering', role:'Engineering Manager',           salary:115000,city:'San Francisco', exp:14, age:41, high:1, tenure:'Experienced'},
  {id:14,name:'Amanda White',       dept:'Data Science',role:'Machine Learning Engineer',     salary:92000, city:'New York',      exp:7,  age:34, high:0, tenure:'Established'},
  {id:15,name:'Christopher Harris', dept:'Finance',     role:'Senior Financial Analyst',      salary:88000, city:'Boston',        exp:11, age:36, high:0, tenure:'Experienced'},
  {id:16,name:'Ashley Clark',       dept:'Marketing',   role:'Digital Marketing Specialist',  salary:58000, city:'Austin',        exp:2,  age:25, high:0, tenure:'New'},
  {id:17,name:'Matthew Lewis',      dept:'Engineering', role:'Cloud Architect',               salary:102000,city:'Seattle',       exp:12, age:38, high:1, tenure:'Experienced'},
  {id:18,name:'Stephanie Walker',   dept:'Data Science',role:'Data Analyst',                  salary:72000, city:'Chicago',       exp:6,  age:32, high:0, tenure:'Established'},
  {id:19,name:'Joshua Hall',        dept:'Engineering', role:'Backend Engineer',              salary:83000, city:'San Francisco', exp:5,  age:29, high:0, tenure:'Established'},
  {id:20,name:'Nicole Allen',       dept:'HR',          role:'HR Business Partner',           salary:70000, city:'New York',      exp:7,  age:31, high:0, tenure:'Established'},
  {id:21,name:'Kevin Young',        dept:'Engineering', role:'Principal Engineer',            salary:125000,city:'San Francisco', exp:16, age:43, high:1, tenure:'Veteran'},
  {id:22,name:'Elizabeth King',     dept:'Data Science',role:'Junior Data Scientist',         salary:68000, city:'Austin',        exp:3,  age:28, high:0, tenure:'New'},
  {id:23,name:'Ryan Wright',        dept:'Finance',     role:'Finance Manager',               salary:95000, city:'Chicago',       exp:10, age:35, high:1, tenure:'Experienced'},
  {id:24,name:'Lauren Scott',       dept:'Marketing',   role:'Product Marketing Manager',     salary:85000, city:'Boston',        exp:6,  age:30, high:0, tenure:'Established'},
  {id:25,name:'Brandon Green',      dept:'Engineering', role:'Site Reliability Engineer',     salary:90000, city:'Seattle',       exp:8,  age:33, high:0, tenure:'Experienced'},
  {id:26,name:'Samantha Adams',     dept:'Data Science',role:'NLP Engineer',                  salary:87000, city:'New York',      exp:4,  age:27, high:0, tenure:'Established'},
  {id:27,name:'Justin Baker',       dept:'Engineering', role:'VP of Engineering',             salary:145000,city:'San Francisco', exp:17, age:40, high:1, tenure:'Veteran'},
  {id:28,name:'Rachel Nelson',      dept:'HR',          role:'Recruiter',                     salary:60000, city:'Austin',        exp:3,  age:26, high:0, tenure:'New'},
  {id:29,name:'Andrew Carter',      dept:'Data Science',role:'Computer Vision Engineer',      salary:96000, city:'Seattle',       exp:9,  age:37, high:1, tenure:'Experienced'},
  {id:30,name:'Michelle Mitchell',  dept:'Finance',     role:'Budget Analyst',                salary:76000, city:'Chicago',       exp:7,  age:32, high:0, tenure:'Established'},
];

const deptMeta = {
  'Engineering': { pill:'pill-eng', color:'#6c63ff' },
  'Data Science':{ pill:'pill-ds',  color:'#00d4aa' },
  'Finance':     { pill:'pill-fin', color:'#ffd166' },
  'HR':          { pill:'pill-hr',  color:'#ff6b6b' },
  'Marketing':   { pill:'pill-mkt', color:'#48cae4' },
};

// ── Chart defaults ────────────────────────────────────────────────────────────
Chart.defaults.color = '#8892a4';
Chart.defaults.borderColor = '#2a2d3e';
Chart.defaults.font.family = "'Segoe UI', system-ui, sans-serif";
const tip = { backgroundColor:'#1a1d27', borderColor:'#2a2d3e', borderWidth:1, titleColor:'#e2e8f0', bodyColor:'#8892a4', padding:10 };
const noGrid = { display:false };
const gridLine = { color:'#2a2d3e' };

// ── Static chart data ─────────────────────────────────────────────────────────
const deptLabels  = ['Engineering','Data Science','Finance','HR','Marketing'];
const deptColors  = ['#6c63ff','#00d4aa','#ffd166','#ff6b6b','#48cae4'];
const deptAvgSal  = [98727, 88500, 85250, 67500, 68333];
const deptCount   = [11, 8, 4, 4, 3];
const deptMin     = [78000, 68000, 76000, 60000, 58000];
const deptMax     = [145000, 105000, 95000, 75000, 85000];

const cityLabels  = ['San Francisco','Austin','New York','Chicago','Seattle','Boston'];
const cityEmpC    = [7, 5, 5, 5, 5, 3];
const cityAvgS    = [109429, 70800, 82800, 80000, 88200, 78333];
const cityPayroll = [766000, 354000, 414000, 400000, 441000, 235000];

// ── Chart 1: Avg salary by dept ───────────────────────────────────────────────
new Chart(document.getElementById('deptSalary'),{type:'bar',data:{labels:deptLabels,datasets:[{label:'Avg Salary',data:deptAvgSal,backgroundColor:deptColors.map(c=>c+'bb'),borderColor:deptColors,borderWidth:2,borderRadius:6}]},options:{indexAxis:'y',responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{callbacks:{label:ctx=>' $'+ctx.parsed.x.toLocaleString()},...tip}},scales:{x:{grid:gridLine,ticks:{callback:v=>'$'+(v/1000).toFixed(0)+'K'}},y:{grid:noGrid}}}});

// ── Chart 2: Headcount donut ──────────────────────────────────────────────────
new Chart(document.getElementById('deptHeadcount'),{type:'doughnut',data:{labels:deptLabels,datasets:[{data:deptCount,backgroundColor:deptColors.map(c=>c+'bb'),borderColor:deptColors,borderWidth:2,hoverOffset:8}]},options:{responsive:true,maintainAspectRatio:false,cutout:'65%',plugins:{legend:{position:'right',labels:{padding:14,boxWidth:12,font:{size:12}}},tooltip:{callbacks:{label:ctx=>` ${ctx.label}: ${ctx.parsed} employees`},...tip}}}});

// ── Chart 3: Salary range grouped bar (Min / Avg / Max) ──────────────────────
new Chart(document.getElementById('deptRange'),{type:'bar',data:{labels:deptLabels,datasets:[{label:'Min',data:deptMin,backgroundColor:'#48cae433',borderColor:'#48cae4',borderWidth:2,borderRadius:4},{label:'Avg',data:deptAvgSal,backgroundColor:deptColors.map(c=>c+'88'),borderColor:deptColors,borderWidth:2,borderRadius:4},{label:'Max',data:deptMax,backgroundColor:'#ff6b6b33',borderColor:'#ff6b6b',borderWidth:2,borderRadius:4}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{boxWidth:10,font:{size:11}}},tooltip:{callbacks:{label:ctx=>' $'+ctx.parsed.y.toLocaleString()},...tip}},scales:{x:{grid:noGrid},y:{grid:gridLine,ticks:{callback:v=>'$'+(v/1000).toFixed(0)+'K'}}}}});

// ── Chart 4: Salary bands ─────────────────────────────────────────────────────
new Chart(document.getElementById('salaryBands'),{type:'bar',data:{labels:['$50-70K','$70-90K','$90-110K','$110-130K','$130K+'],datasets:[{data:[6,14,7,2,1],backgroundColor:['#48cae4bb','#00d4aabb','#6c63ffbb','#ffd166bb','#ff6b6bbb'],borderColor:['#48cae4','#00d4aa','#6c63ff','#ffd166','#ff6b6b'],borderWidth:2,borderRadius:6}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{...tip}},scales:{y:{grid:gridLine,ticks:{stepSize:2}},x:{grid:noGrid}}}});

// ── Chart 5: Experience bands + salary line ───────────────────────────────────
new Chart(document.getElementById('expBands'),{type:'bar',data:{labels:['Entry\n0-2yr','Junior\n3-5yr','Mid\n6-10yr','Senior\n11-15yr','Expert\n16+yr'],datasets:[{label:'Employees',data:[1,9,13,4,3],backgroundColor:'#6c63ffbb',borderColor:'#6c63ff',borderWidth:2,borderRadius:6,yAxisID:'y'},{label:'Avg Salary',data:[58000,74222,88615,95000,117333],type:'line',borderColor:'#00d4aa',backgroundColor:'#00d4aa11',borderWidth:2,pointBackgroundColor:'#00d4aa',pointRadius:4,tension:0.4,fill:true,yAxisID:'y2'}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{boxWidth:10,font:{size:11}}},tooltip:{callbacks:{label:ctx=>ctx.datasetIndex===1?' Avg Salary: $'+ctx.parsed.y.toLocaleString():' Employees: '+ctx.parsed.y},...tip}},scales:{y:{grid:gridLine,position:'left',ticks:{stepSize:2}},y2:{grid:noGrid,position:'right',ticks:{callback:v=>'$'+(v/1000).toFixed(0)+'K'}},x:{grid:noGrid}}}});

// ── Chart 6: Tenure category donut ────────────────────────────────────────────
new Chart(document.getElementById('tenureDonut'),{type:'doughnut',data:{labels:['New (0-3yr)','Established (4-7yr)','Experienced (8-15yr)','Veteran (16+yr)'],datasets:[{data:[4,13,10,3],backgroundColor:['#48cae4bb','#6c63ffbb','#00d4aabb','#ffd166bb'],borderColor:['#48cae4','#6c63ff','#00d4aa','#ffd166'],borderWidth:2,hoverOffset:8}]},options:{responsive:true,maintainAspectRatio:false,cutout:'58%',plugins:{legend:{position:'right',labels:{padding:12,boxWidth:11,font:{size:11}}},tooltip:{callbacks:{label:ctx=>` ${ctx.label}: ${ctx.parsed} employees`},...tip}}}});

// ── Chart 7: Age distribution ─────────────────────────────────────────────────
new Chart(document.getElementById('ageDist'),{type:'bar',data:{labels:['25-29','30-34','35-39','40-44','45+'],datasets:[{label:'Employees',data:[9,9,7,4,1],backgroundColor:['#6c63ffbb','#00d4aabb','#ffd166bb','#ff6b6bbb','#48cae4bb'],borderColor:['#6c63ff','#00d4aa','#ffd166','#ff6b6b','#48cae4'],borderWidth:2,borderRadius:6}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{...tip}},scales:{y:{grid:gridLine,ticks:{stepSize:2}},x:{grid:noGrid}}}});

// ── Chart 8: Scatter — Salary vs Experience ───────────────────────────────────
const scatterDatasets = Object.entries(deptMeta).map(([dept,meta])=>({
  label: dept,
  data: employees.filter(e=>e.dept===dept).map(e=>({x:e.exp,y:e.salary,name:e.name,role:e.role})),
  backgroundColor: meta.color+'bb',
  borderColor: meta.color,
  borderWidth:1.5,
  pointRadius:7,
  pointHoverRadius:9,
}));
new Chart(document.getElementById('scatter'),{type:'scatter',data:{datasets:scatterDatasets},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{boxWidth:11,font:{size:12},padding:16}},tooltip:{callbacks:{title:()=>'',label:ctx=>[` ${ctx.raw.name}`,' '+ctx.raw.role,` Exp: ${ctx.raw.x} yr  |  Salary: $${ctx.raw.y.toLocaleString()}`]},...tip}},scales:{x:{grid:gridLine,title:{display:true,text:'Experience (years)',color:'#8892a4',font:{size:11}},ticks:{callback:v=>v+' yr'}},y:{grid:gridLine,title:{display:true,text:'Salary ($)',color:'#8892a4',font:{size:11}},ticks:{callback:v=>'$'+(v/1000).toFixed(0)+'K'}}}}});

// ── City charts ───────────────────────────────────────────────────────────────
new Chart(document.getElementById('cityEmp'),{type:'bar',data:{labels:cityLabels,datasets:[{data:cityEmpC,backgroundColor:'#6c63ffbb',borderColor:'#6c63ff',borderWidth:2,borderRadius:6}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{...tip}},scales:{y:{grid:gridLine,ticks:{stepSize:1}},x:{grid:noGrid}}}});
new Chart(document.getElementById('citySalary'),{type:'bar',data:{labels:cityLabels,datasets:[{data:cityAvgS,backgroundColor:'#00d4aabb',borderColor:'#00d4aa',borderWidth:2,borderRadius:6}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{callbacks:{label:ctx=>' $'+ctx.parsed.y.toLocaleString()},...tip}},scales:{y:{grid:gridLine,ticks:{callback:v=>'$'+(v/1000).toFixed(0)+'K'}},x:{grid:noGrid}}}});
new Chart(document.getElementById('cityPayroll'),{type:'bar',data:{labels:cityLabels,datasets:[{data:cityPayroll,backgroundColor:'#ffd166bb',borderColor:'#ffd166',borderWidth:2,borderRadius:6}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{callbacks:{label:ctx=>' $'+ctx.parsed.y.toLocaleString()},...tip}},scales:{y:{grid:gridLine,ticks:{callback:v=>'$'+(v/1000).toFixed(0)+'K'}},x:{grid:noGrid}}}});

// ── Chart: Top 15 roles by salary ────────────────────────────────────────────
const topRoles=[
  {role:'VP of Engineering',sal:145000,dept:'Engineering'},
  {role:'Principal Engineer',sal:125000,dept:'Engineering'},
  {role:'Engineering Manager',sal:115000,dept:'Engineering'},
  {role:'AI Research Scientist',sal:105000,dept:'Data Science'},
  {role:'Cloud Architect',sal:102000,dept:'Engineering'},
  {role:'Senior Data Scientist',sal:98000,dept:'Data Science'},
  {role:'Computer Vision Engineer',sal:96000,dept:'Data Science'},
  {role:'Senior Data Engineer',sal:95000,dept:'Engineering'},
  {role:'Finance Manager',sal:95000,dept:'Finance'},
  {role:'Machine Learning Engineer',sal:92000,dept:'Data Science'},
  {role:'Site Reliability Engineer',sal:90000,dept:'Engineering'},
  {role:'Data Scientist',sal:90000,dept:'Data Science'},
  {role:'DevOps Engineer',sal:88000,dept:'Engineering'},
  {role:'Senior Financial Analyst',sal:88000,dept:'Finance'},
  {role:'NLP Engineer',sal:87000,dept:'Data Science'},
];
new Chart(document.getElementById('topRoles'),{type:'bar',data:{labels:topRoles.map(r=>r.role),datasets:[{data:topRoles.map(r=>r.sal),backgroundColor:topRoles.map(r=>deptMeta[r.dept].color+'bb'),borderColor:topRoles.map(r=>deptMeta[r.dept].color),borderWidth:2,borderRadius:6}]},options:{indexAxis:'y',responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{callbacks:{label:ctx=>' $'+ctx.parsed.x.toLocaleString()},...tip}},scales:{x:{grid:gridLine,ticks:{callback:v=>'$'+(v/1000).toFixed(0)+'K'}},y:{grid:noGrid,ticks:{font:{size:11}}}}}});

// ── Employee table with filter/search/sort ────────────────────────────────────
const tbody      = document.getElementById('empTable');
const searchEl   = document.getElementById('searchInput');
const cityFilter = document.getElementById('cityFilter');
const sortSelect = document.getElementById('sortSelect');
const highToggle = document.getElementById('highToggle');
const countEl    = document.getElementById('resultCount');
const deptBtns   = document.querySelectorAll('.dpill');

const maxSalary = Math.max(...employees.map(e=>e.salary));

let state = { dept:'All', city:'All', highOnly:false, sort:'id', query:'' };

function renderTable() {
  let list = [...employees];

  // filter
  if (state.query)    list = list.filter(e => (e.name+' '+e.role).toLowerCase().includes(state.query));
  if (state.dept !== 'All') list = list.filter(e => e.dept === state.dept);
  if (state.city !== 'All') list = list.filter(e => e.city === state.city);
  if (state.highOnly) list = list.filter(e => e.high);

  // sort
  const [field, dir] = state.sort.includes('-') ? state.sort.split('-') : [state.sort, 'asc'];
  list.sort((a,b)=>{
    if (field==='name')   return dir==='asc' ? a.name.localeCompare(b.name) : b.name.localeCompare(a.name);
    if (field==='salary') return dir==='asc' ? a.salary-b.salary : b.salary-a.salary;
    if (field==='exp')    return dir==='asc' ? a.exp-b.exp : b.exp-a.exp;
    return a.id-b.id;
  });

  // sort header indicators
  document.querySelectorAll('th[data-sort]').forEach(th=>{
    th.classList.remove('sort-asc','sort-desc');
    if (th.dataset.sort===field) th.classList.add(dir==='desc'?'sort-desc':'sort-asc');
  });

  // render rows
  tbody.innerHTML = '';
  if (!list.length) {
    tbody.innerHTML = '<tr><td colspan="8" class="no-results">No employees match your filters.</td></tr>';
  } else {
    list.forEach(e => {
      const barW = Math.round((e.salary/maxSalary)*80);
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td style="color:var(--muted)">${e.id}</td>
        <td><strong>${e.name}</strong><br><span style="color:var(--muted);font-size:.72rem">${e.tenure}</span></td>
        <td><span class="pill ${deptMeta[e.dept].pill}">${e.dept}</span></td>
        <td style="color:var(--muted);font-size:.77rem">${e.role}</td>
        <td>
          <div class="sal-bar-wrap">
            <span class="salary">$${e.salary.toLocaleString()}</span>
            <div class="sal-bar" style="width:${barW}px"></div>
          </div>
        </td>
        <td>${e.city}</td>
        <td>${e.exp} yr</td>
        <td>${e.high?'<span class="high">★ High</span>':'<span style="color:var(--muted)">—</span>'}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  countEl.innerHTML = `<strong>${list.length}</strong> of ${employees.length} employees`;
}

// events
searchEl.addEventListener('input',  e => { state.query = e.target.value.toLowerCase(); renderTable(); });
cityFilter.addEventListener('change',e => { state.city  = e.target.value; renderTable(); });
sortSelect.addEventListener('change',e => { state.sort  = e.target.value; renderTable(); });
highToggle.addEventListener('click', () => {
  state.highOnly = !state.highOnly;
  highToggle.classList.toggle('active', state.highOnly);
  renderTable();
});
deptBtns.forEach(btn => {
  btn.addEventListener('click', () => {
    deptBtns.forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    state.dept = btn.dataset.dept;
    renderTable();
  });
});
document.querySelectorAll('th[data-sort]').forEach(th => {
  th.addEventListener('click', () => {
    const field = th.dataset.sort;
    const curDir = th.classList.contains('sort-asc') ? 'asc' : 'desc';
    state.sort = field + '-' + (curDir === 'asc' ? 'desc' : 'asc');
    sortSelect.value = state.sort in ['id','name-asc','salary-desc','salary-asc','exp-desc','exp-asc'] ? state.sort : 'id';
    renderTable();
  });
});

renderTable();
</script>
</body>
</html>
